# テストガイド

## 概要

このドキュメントでは、医療カルテ文字抽出アプリケーションのテスト手順とアプローチについて説明します。

## テスト環境の設定

1. 開発環境をセットアップします（`setup.md`を参照）。

2. テスト用の環境変数を設定します（本番とは別のSupabaseプロジェクトを使用することを推奨）。

## テスト種別

### 1. ユニットテスト

バックエンドの各関数とAPIエンドポイントの動作を個別にテストします。

```bash
cd backend
python -m pytest tests/unit/
```

### 2. 統合テスト

バックエンドとフロントエンドの統合をテストします。

```bash
cd backend
python -m pytest tests/integration/
```

### 3. マニュアルテスト

以下のシナリオを手動でテストします：

1. **画像アップロードテスト**
   - サンプルカルテ画像をアップロードします
   - 処理状況が正しく表示されることを確認します
   - 処理完了後、抽出結果が正しく表示されることを確認します

2. **履歴表示テスト**
   - 処理履歴ページにアクセスします
   - すべてのカルテレコードが正しく表示されることを確認します
   - 各レコードの詳細ページにアクセスして処理結果を確認します

3. **エラーハンドリングテスト**
   - 非対応形式のファイル（例：PDFやテキストファイル）をアップロードしてその動作を確認します
   - 大きすぎるファイル（10MB以上）をアップロードしてその動作を確認します
   - 間違ったUUIDで詳細ページにアクセスしたときのエラーメッセージを確認します

## パフォーマンステスト

1. **画像処理時間**
   - カルテ画像のアップロードから処理完了までの時間を計測します
   - 目標時間: 10秒以内

2. **同時リクエスト処理**
   - 複数のクライアントから同時にリクエストを送信し、システムの動作とレスポンス時間を確認します

## セキュリティテスト

1. **ファイルタイプのバリデーション**
   - 不正なファイルタイプ（実行可能ファイルなど）が拒否されることを確認します

2. **ファイルサイズのバリデーション**
   - 大きすぎるファイルが拒否されることを確認します

## テストデータ

テストには、`docs/sample_data.md`に記載されているサンプルデータとサンプル画像を使用します。

## テストレポート

各テスト実行後、以下の情報を含むテストレポートを作成します：

- 実行したテストの種類
- テストの成功/失敗状況
- 発生したエラーや警告
- パフォーマンス指標（処理時間など）
- 改善点や記録すべき問題点

テストレポートは、プロジェクトの品質向上と改善のための重要なドキュメントとして保存します。